var impressionTagOptions = {"creatives":{"315736":{"size":{"width":728,"height":90},"channels":{"feature":{"dynodeBaseUrl":{"no_ssl":"http://dynode.spongecell.com","ssl":"https://dynode.spongecell.com"},"studioAssetBaseUrl":{"no_ssl":"http://live.cdn.spongecell.com","ssl":"https://live-ssl.cdn.spongecell.com"},"ipLocateUrl":{"no_ssl":"http://dynode.spongecell.com/location.js","ssl":"https://dynode.spongecell.com/location.js"},"locationsUrl":{"no_ssl":"http://locations.cdn.spongecell.com/api/locations.js","ssl":"https://locations-ssl.cdn.spongecell.com/api/locations.js"},"features":[]},"setup":{"features":[],"landingPages":{"":"http://www.united.com/web/en-US/apps/booking/flight/searchRT.aspx"},"api":{"landingPages":{}},"adRevision":1418942707,"creativeSwfUrl":{"no_ssl":"http://live.cdn.spongecell.com/2014/united/q4/generic/v5.2.6/assets/Right_Place_Right_Price_728x90.swf","ssl":"https://live-ssl.cdn.spongecell.com/2014/united/q4/generic/v5.2.6/assets/Right_Place_Right_Price_728x90.swf"},"sharedBaseUrl":{"no_ssl":"http://widgets.cdn.spongecell.com/v5.2.6","ssl":"https://widgets-ssl.cdn.spongecell.com/v5.2.6"},"urls":{"heatMapBaseUrl":{"no_ssl":"http://fire.spongecell.com","ssl":"https://fire.spongecell.com"},"liveBaseUrl":{"no_ssl":"http://live.cdn.spongecell.com","ssl":"https://live-ssl.cdn.spongecell.com"},"liveSubPath":"2014/united/q4/generic/v5.2.6","form":"https://royale-ssl.spongecell.com/api/campaigns/9492/submit_form","message":"https://royale-ssl.spongecell.com/api/widgets/315736/send_message"}},"tracking":{"heatMapBaseUrl":{"no_ssl":"http://fire.spongecell.com","ssl":"https://fire.spongecell.com"},"trackingBaseUrl":{"no_ssl":"http://analytics.spongecell.com/ad_tags","ssl":"https://analytics.spongecell.com/ad_tags"},"heatMapEnabled":true,"trackingEnabled":true,"macros":{"placementId":["%epid!","SPONGECELL_PLACEMENT_ID"],"siteId":["%s","SPONGECELL_SITE_ID"],"activityPixel":["SPONGECELL_ACTIVITY_PIXEL"]},"pixels":{"impression":null,"impressions":[],"dynode":null,"dynodes":[],"engagement":null,"engagements":[],"completion":null,"completions":[],"expansion":null,"expansions":[],"clickThrough":null,"clickThroughs":[],"start":null,"starts":[],"firstQuartile":null,"firstQuartiles":[],"midpoint":null,"midpoints":[],"thirdQuartile":null,"thirdQuartiles":[],"complete":null,"completes":[]},"adTag":{"id":51273843,"name":"Standard Animation_728x90"},"container":{"id":1936},"campaign":{"id":9492},"creative":{"id":315736,"name":"Standard Animation","width":728,"height":90},"concept":{"id":7917},"weight":{"value":1.0},"rotationGroup":{"id":7272},"flight":{"id":23659,"name":"MEC"},"placement":{"id":"%epid!","name":"Standard Animation"},"site":{"id":""}}},"tags":{"backup":{"imageUrl":{"no_ssl":"http://live.cdn.spongecell.com/2014/united/q4/generic/v5.2.6/assets/728x90.jpg","ssl":"https://live-ssl.cdn.spongecell.com/2014/united/q4/generic/v5.2.6/assets/728x90.jpg"},"linkUrl":"https://royale-ssl.spongecell.com/api/ad_tags/51273843/clickthrough?creative_id=315736\u0026noflash=true\u0026iid=**iid**\u0026external_placement_id=**placement_id**\u0026external_site_id=**site_id**\u0026anticache=**random**\u0026click_tag=**click_tag**","size":{"width":728,"height":90}},"flash":{"gridSwfUrl":{"no_ssl":"http://live.cdn.spongecell.com/2014/united/q4/generic/v5.2.6/bin/LeaderboardGrid.swf?r=1418942707","ssl":"https://live-ssl.cdn.spongecell.com/2014/united/q4/generic/v5.2.6/bin/LeaderboardGrid.swf?r=1418942707"},"size":{"width":728,"height":90},"displayUrl":"","blankDisplayUrl":false}},"weight":1.0}},"channels":{"setup":true,"tracking":true},"tags":{"backup":true,"flash":true}};
(function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Cookie=function(){function e(){}return e.createCookie=function(e,t,n){var i,r;return null==n&&(n=24),navigator.cookieEnabled?(i=new Date,i.setTime(i.getTime()+60*parseInt(n)*60*1e3),r="; expires="+i.toGMTString(),document.cookie=e+"="+t+r+"; path=/"):null},e.readCookie=function(e){var t,n,i,r,a,o;if(!navigator.cookieEnabled)return null;for(o=e+"=",n=document.cookie.split(";"),i=0,r=0,a=n.length;a>r;r++)if(t=n[r]," "===t[0]&&(t=t.substring(1,t.length)),0===t.indexOf(o))return t.substring(o.length,t.length);return null},e}()}).call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Browser=function(){function e(){}return e.isAndroidSupported=function(){return!!/Android ([2].?[3-9].?[0-9]?|[4-5].?[0-9].?[0-9]?)/.test(navigator.userAgent)},e.isAndroidGingerbread=function(){return!!/Android ([2].?[3-9].?[0-9]?)/.test(navigator.userAgent)},e.isAndroidIceCreamSandwich=function(){return!!/Android ([4].?[0].?[0-9]?)/.test(navigator.userAgent)},e.isAndroidJellyBean=function(){return!!/Android (4.?[1-3].?\d?)/.test(navigator.userAgent)},e.isAndroid41=function(){return!!/Android (4.?1.?\d?)/.test(navigator.userAgent)},e.isAndroid42=function(){return!!/Android (4.?2.?\d?)/.test(navigator.userAgent)},e.isAndroid43=function(){return!!/Android (4.?3.?\d?)/.test(navigator.userAgent)},e.isAndroidLollipop=function(){return!!/Android ([5].?[0-9].?[0-9]?)/.test(navigator.userAgent)},e.isAndroid=function(){return!!/(Android);?[\s\/]+([\d.]+)?/.test(navigator.userAgent)},e.isIE8=function(){return/MSIE ([8]{1,}[\.0-9]{0,})/.test(navigator.userAgent)},e.isIE9=function(){return/MSIE ([9]{1,}[\.0-9]{0,})/.test(navigator.userAgent)},e.isIE10=function(){return/MSIE ([10]{1,}[\.0-9]{0,})/.test(navigator.userAgent)},e.isIE11=function(){return/Trident\/.*rv:(11.\d+)/.test(navigator.userAgent)},e.isIE9Below=function(){return this.isIE8()||this.isIE9()},e.isIE10Below=function(){return/MSIE ([0-9]{1,}[\.0-9]{0,})/.test(navigator.userAgent)},e.isIE=function(){return this.isIE11()||this.isIE10Below()},e.isiOS5=function(){var e;return!!(null!=(e=$.os)?e.ios:void 0)&&5===parseInt($.os.version)},e.isMobile=function(){var e,t;return!!(null!=(e=$.os)?e.tablet:void 0)||!!(null!=(t=$.os)?t.phone:void 0)},e.isChrome=function(){return/Chrome|Spotify/.test(navigator.userAgent)},e.isFirefox=function(){return/Firefox/.test(navigator.userAgent)},e.isSafari=function(){return/Safari/.test(navigator.userAgent)},e.isWindowsSafari=function(){return/Windows.*AppleWebKit.*Safari/.test(navigator.userAgent)&&!/Chrome|Spotify/.test(navigator.userAgent)},e.supportsFullscreen=function(){return!this.isIE()&&!this.isWindowsSafari()},e.supportsSrcdoc=function(){return!this.isSafari()&&!this.isChrome()},e.detectsSrcdoc=function(){return"about:srcdoc"===window.location.href},e}()}.call(this),function(){var e,t,n=[].slice;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Console=function(){function e(){}return e.ENABLED=function(){var e;return!!(null!=(e=t.Cookie)?e.readCookie("_console_logging"):void 0)}(),e.log=function(){var e,t,i;return t=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],this.ENABLED&&window.console?null!=window.console.log.apply?(i=window.console).log.apply(i,[t].concat(n.call(e))):window.console.log(t):void 0},e.debug=function(){var e,i,r,a,o;return i=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],this.ENABLED&&window.console?null!=(null!=(r=window.console.debug)?r.apply:void 0)?(a=window.console).debug.apply(a,[i].concat(n.call(e))):(o=t.Console).log.apply(o,[i].concat(n.call(e))):void 0},e.pad=function(e,t){var n;for(n=e||"";n.length<t;)n+=" ";return n},e.groupCollapsedSupported=function(){var e,t;return null!=(null!=(e=window.console)&&null!=(t=e.groupCollapsed)?t.apply:void 0)},e.group=function(){var e,i,r,a;return i=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],this.ENABLED?this.groupCollapsedSupported()?(r=window.console).groupCollapsed.apply(r,[i].concat(n.call(e))):(a=t.Console).log.apply(a,[i].concat(n.call(e))):void 0},e.groupEnd=function(){var e;return this.ENABLED&&(null!=(e=window.console)?e.groupEnd:void 0)?window.console.groupEnd():void 0},e}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Event=function(){function e(){}return e.onLoad=function(e){return document&&"complete"===document.readyState?void setTimeout(function(){return e()},0):"undefined"!=typeof window.addEventListener?window.addEventListener("load",e,!1):"undefined"!=typeof document.addEventListener?document.addEventListener("load",e,!1):"undefined"!=typeof window.attachEvent?window.attachEvent("onload",e):void 0},e.on=function(e,t,n){return"undefined"!=typeof document.addEventListener?e.addEventListener(t,n,!1):"undefined"!=typeof document.attachEvent?e.attachEvent("on"+t,n):void 0},e}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Expansion=function(){function n(){}return n.getWindow=function(){return this.allowedAccessToTop()?null!=e?e.top:window:null!=e?e:window},n.getDocument=function(t){return null==t&&(t="expandable"),this.inIframe()&&"overlay"!==t?e.document:this.getWindow().document},n.documentDimensions=function(){var e,t;return e=this.getDocument(),t=this.getWindow(),{height:t.innerHeight||e.documentElement.clientHeight||e.body.clientHeight,width:t.innerWidth||e.documentElement.clientWidth||e.body.clientWidth}},n.pageDimensions=function(){var e,t;return e=this.getDocument(),t=this.getWindow(),{width:t.innerWidth||e.documentElement.clientWidth||e.body.clientWidth,height:t.innerHeight||e.documentElement.clientHeight||e.body.clientHeight}},n.inIframe=function(){var t;try{return e!==top}catch(n){return t=n,!0}},n.inFriendlyIframe=function(){var t;try{return void 0===e.parent.location.host?!1:!0}catch(n){return t=n,!1}},n.allowedAccessToTop=function(){return!this.inIframe()||this.inFriendlyIframe()?(t.Console.log("allowed access to parent window"),!0):!1},n.fixedPositionSupported=function(){var e,t,n,i;return t=this.getDocument(),n=1,i=!1,e=t.createElement("div"),e.style.position="fixed",e.style.top="0px",e.style.right="0px",t.body.appendChild(e),"number"==typeof e.offsetTop&&null!==e.offsetTop&&"undefined"!==e.offsetTop&&(n=parseInt(e.offsetTop)),0===n&&(i=!0),e.parentNode.removeChild(e),i},n.panelLargerThanWindow=function(e){var t,n,i;return i=this.getWindow(),t=i.innerHeight?i.document.documentElement.clientHeight:i.document.body.scrollHeight,n=i.innerWidth?i.document.documentElement.clientWidth:i.document.body.scrollWidth,t<e.height||n<e.width?!0:!1},n.calcPositions=function(e,t){return t.x||t.y?this.calcAbsolutePositions(e,t):this.fixedPositionSupported()?this.calcFixedPositions(e):this.calcAbsolutePositions(e)},n.calcFixedPositions=function(e){var t,n,i,r,a,o,s,l,u,c;return t=this.getDocument(),l=this.getWindow(),r=e.height,s=e.width,n=this.documentDimensions().height,i=this.documentDimensions().width,o=(n-r)/2-1,c=this.panelLargerThanWindow(e)||0>o?0:o,a=(i-s)/2-1,u=0>a?0:a,["fixed",u,c]},n.calcAbsolutePositions=function(e,t){var n,i,r,a,o,s,l,u,c,d,h,p,f;return null==t&&(t={}),n=this.getDocument(),h=this.getWindow(),a=e.height,d=e.width,t.x=t.x?parseInt(t.x):0,t.y=t.y?parseInt(t.y):0,i=this.documentDimensions().height,r=this.documentDimensions().width,u=this.scrollPositions(),l=u[0],c=u[1],s=c+(i-a)/2-1,f=this.panelLargerThanWindow(e)||0>s?0:s,o=l+(r-d)/2-1,p=0>o?0:o,["absolute",p+t.x,f+t.y]},n.scrollPositions=function(){var e,t,n;return t=this.getDocument(),n=this.getWindow(),e=t.body,"number"==typeof n.pageYOffset?[n.pageXOffset,n.pageYOffset]:e&&(e.scrollLeft||e.scrollTop)?[e.scrollLeft,e.scrollTop]:t.documentElement&&(t.documentElement.scrollLeft||t.documentElement.scrollTop)?[t.documentElement.scrollLeft,t.documentElement.scrollTop]:[0,0]},n}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Flash=function(){function e(){}return e.isIE=-1!==navigator.appVersion.indexOf("MSIE")?!0:!1,e.isWin=-1!==navigator.appVersion.toLowerCase().indexOf("win")?!0:!1,e.isOpera=-1!==navigator.userAgent.indexOf("Opera")?!0:!1,e.controlVersion=function(){var e,t,n;n=void 0,e=void 0,t=void 0;try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),n=e.GetVariable("$version")}catch(i){}if(!n)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),n="WIN 6,0,21,0",e.AllowScriptAccess="always",n=e.GetVariable("$version")}catch(i){}if(!n)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),n=e.GetVariable("$version")}catch(i){}if(!n)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),n="WIN 3,0,18,0"}catch(i){}if(!n)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),n="WIN 2,0,0,11"}catch(i){t=i,n=-1}return n},e.getSwfVer=function(){var e,t,n,i,r,a,o,s;return n=-1,null!=navigator.plugins&&navigator.plugins.length>0?(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"])&&(i=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",t=navigator.plugins["Shockwave Flash"+i].description,e=t.split(" "),r=e[2].split("."),a=r[0],o=r[1],s=e[3],""===s&&(s=e[4]),"d"===s[0]?s=s.substring(1):"r"===s[0]&&(s=s.substring(1),s.indexOf("d")>0&&(s=s.substring(0,s.indexOf("d")))),n=a+"."+o+"."+s):-1!==navigator.userAgent.toLowerCase().indexOf("webtv/2.6")?n=4:-1!==navigator.userAgent.toLowerCase().indexOf("webtv/2.5")?n=3:-1!==navigator.userAgent.toLowerCase().indexOf("webtv")?n=2:this.isIE&&this.isWin&&!this.isOpera&&(n=this.controlVersion()),n},e.detectFlashVer=function(e,t,n){var i,r,a,o,s,l,u;if(u=this.getSwfVer(),a=null,-1===u)return!1;if(0!==u){if(this.isIE&&this.isWin&&!this.isOpera?(i=u.split(" "),r=i[1],a=r.split(",")):a=u.split("."),o=a[0],s=a[1],l=a[2],o>parseFloat(e))return!0;if(o===parseFloat(e)){if(s>parseFloat(t))return!0;if(s===parseFloat(t)&&l>=parseFloat(n))return!0}return!1}},e.html=function(e,n,i,r,a){return null==a&&(a=""),t.Browser.isIE11()?'<object id="'+e+'" width="'+i+'" height="'+r+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" class="spongecell-flash">\n  <param name="allowFullScreen" value="true">\n  <param name="allowNetworking" value="all">\n  <param name="allowScriptAccess" value="always">\n  <param name="base" value=".">\n  <param name="flashvars" value="'+a+'">\n  <param name="movie" value="'+n+'">\n  <param name="quality" value="high">\n  <param name="salign" value="tl">\n  <param name="wmode" value="opaque">\n  <object name="'+e+'" data="'+n+'" type="application/x-shockwave-flash" height="'+r+'" width="'+i+'" class="spongecell-flash">\n    <param name="flashvars" value="'+a+'"></param>\n    <param name="base", value="."></param>\n    <param name="allowScriptAccess" value="always"></param>\n    <param name="allowNetworking" value="all"></param>\n    <param name="allowFullScreen" value="true"></param>\n    <param name="wmode" value="opaque"></param>\n    <param name="salign" value="tl"></param>\n    <param name="quality" value="high"></param>\n  </object>\n</object>':'<object id="'+e+'" width="'+i+'" height="'+r+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" class="spongecell-flash">\n  <param name="allowFullScreen" value="true">\n  <param name="allowNetworking" value="all">\n  <param name="allowScriptAccess" value="always">\n  <param name="base" value=".">\n  <param name="flashvars" value="'+a+'">\n  <param name="movie" value="'+n+'">\n  <param name="quality" value="high">\n  <param name="salign" value="tl">\n  <param name="wmode" value="opaque">\n  <!--[if !IE]>-->\n  <object name="'+e+'" allowFullScreen="true" allowNetworking="all" allowScriptAccess="always" base="." data="'+n+'" height="'+r+'" quality="high" salign="tl" type="application/x-shockwave-flash" width="'+i+'" wmode="opaque" class="spongecell-flash">\n    <param name="flashvars" value="'+a+'">\n  </object>\n  <!--<![endif]-->\n</object>'},e}()}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=["extended","included"],spongecell.Module=function(){function n(){}return n.extend=function(n){var i,r,a;for(i in n)a=n[i],t.call(e,i)<0&&(this[i]=a);return null!=(r=n.extended)&&r.apply(this),this},n.include=function(n){var i,r,a;for(i in n)a=n[i],t.call(e,i)<0&&(this.prototype[i]=a);return null!=(r=n.included)&&r.apply(this),this},n}()}.call(this),/*! promise-polyfill 2.0.1 */
!function(e){function t(e,t){return function(){e.apply(t,arguments)}}function n(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(e,t(r,this),t(a,this))}function i(e){var t=this;return null===this._state?void this._deferreds.push(e):void u(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return void(t._state?e.resolve:e.reject)(t._value);var i;try{i=n(t._value)}catch(r){return void e.reject(r)}e.resolve(i)})}function r(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void l(t(n,e),t(r,this),t(a,this))}this._state=!0,this._value=e,o.call(this)}catch(i){a.call(this,i)}}function a(e){this._state=!1,this._value=e,o.call(this)}function o(){for(var e=0,t=this._deferreds.length;t>e;e++)i.call(this,this._deferreds[e]);this._deferreds=null}function s(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function l(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(r){if(i)return;i=!0,n(r)}}var u=n.immediateFn||"function"==typeof setImmediate&&setImmediate||function(e){setTimeout(e,1)},c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){var r=this;return new n(function(n,a){i.call(r,new s(e,t,n,a))})},n.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&c(arguments[0])?arguments[0]:arguments);return new n(function(t,n){function i(a,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var s=o.then;if("function"==typeof s)return void s.call(o,function(e){i(a,e)},n)}e[a]=o,0===--r&&t(e)}catch(l){n(l)}}if(0===e.length)return t([]);for(var r=e.length,a=0;a<e.length;a++)i(a,e[a])})},n.resolve=function(e){return e&&"object"==typeof e&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,n){n(e)})},n.race=function(e){return new n(function(t,n){for(var i=0,r=e.length;r>i;i++)e[i].then(t,n)})},"undefined"!=typeof module&&module.exports?module.exports=n:e.Promise||(e.Promise=n)}(this),function(){"use strict";var e,t;t=null!=window.spongecell?window.spongecell:window.spongecell={},e=null!=t.requestMap?t.requestMap:t.requestMap={},t.Net=function(){function n(){}return n.isSSL=function(){var e;return"https:"===document.location.protocol||(null!=(e=document.baseURI)?e.indexOf("https"):void 0)>-1},n.isHttp=function(e){return!!/^https?\:\/\//i.test(e)},n.isHttpEncoded=function(e){return/^https?\%3a\%2f\%2f/i.test(e)},n.encode=function(e){return e?encodeURIComponent(e):null},n.writePixel=function(e,n){var i,r;return t.Net.isHttp(e)?(i=document.createElement("div"),i.setAttribute("style","position:absolute;left:0px;top:0px;visibility:hidden;"),r=document.createElement("img"),r.setAttribute("width",0),r.setAttribute("height",0),r.setAttribute("style","width:0px;height:0px;"),r.setAttribute("src",e),i.appendChild(r),(null!=n?n:document.body).appendChild(i)):void 0},n.writeRequest=function(e){var n;return n=this,new Promise(function(i,r){return t.Browser.isIE9Below()?n.writeScript(e,i,r):window.hasOwnProperty("fetch")?window.fetch(e):n.ajax(e,i,r)})},n.writeScript=function(n,i,r,a,o){var s,l,u;if(null==o&&(o=null),o=null!=o?o:document,this.isSSL()&&(n=n.replace(/^http:\/\//,"https://")),null!=i){if(n+=n.indexOf("?")>0?"&":"?",e[n])return this.nestCallbackFn(e[n],i);n+="callback="+(e[n]=t.Broker.registerCallbackFn(i))}return u=o.createElement("script"),u.defer=u.async=!0,u.src=n,null!=r&&(u.onload=r),u.onerror=null!=a?a:null!=r?r:void 0,(null!=(l=t.Browser)?l.isIE8():void 0)&&(u.onreadystatechange=function(){return"loaded"===this.readyState?r():void 0}),s=o.getElementsByTagName("head")[0],s.appendChild(u)},n.ajax=function(e,t,n,i,r,a){var o,s,l,u;if(null==i&&(i=!1),null==r&&(r={}),null==a&&(a="function"==typeof(o="undefined"!=typeof XMLHttpRequest&&null!==XMLHttpRequest?XMLHttpRequest:ActiveXObject)?new o("MSXML2.XMLHTTP.3.0"):void 0),!a)return this.writeScript.apply(this,arguments);if(l=setTimeout(function(){return a.abort(),n({error:"AJAX request timed out"})},2e3),a.withCredentials=!0,a.onreadystatechange=function(){var e,i,r;if(!(a.readyState<4)){clearTimeout(l);try{e=JSON.parse(a.responseText)}catch(o){return i=o,n({error:i})}switch(r=a.status){case 200:return t(e,a);default:return n({error:"AJAX request responded with a "+r})}}},a.open("GET",e,!0),a.setRequestHeader){for(s in r)u=r[s],a.setRequestHeader(s,u);i&&a.setRequestHeader("X-Requested-With","XMLHttpRequest")}return a.send(""),a},n.getParam=function(e,t,n){var i;return null==n&&(n="&"),null!=(i=this.getParams(t,n)[e])?i:""},n.getParams=function(e,t){var n,i,r,a,o,s;for(o={},s=e.split(t),n=0,r=s.length;r>n;n++)a=s[n],i=a.split("="),2===i.length&&(o[i[0]]=i[1]);return o},n.nestCallbackFn=function(e,n){var i,r;return i=e.split(".").pop(),r=t.callbacks[i],t.callbacks[i]=function(){var e,i,a;e=[];for(i in arguments)a=arguments[i],e[i]="object"==typeof a?t.Utils.extend({},a):a;return r.apply(null,arguments),void n.apply(null,e)}},n.scrubTargeting=function(e,t){var n;return"ysa"===e&&(n=decodeURIComponent(t).match(/yud=(.*)/))?n[1]:t},n}()}.call(this),function(){"use strict";var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Utils=function(){function e(){}return e.extend=function(e){var t,n,i,r,a,o;if(arguments.length>1)for(t=Array.prototype.slice.call(arguments,1,arguments.length),i=0,r=t.length;r>i;i++)if(a=t[i],"object"==typeof a)for(n in a)o=a[n],e[n]=o;return e},e.generateIID=function(){return"xxxx-xxxx-Axxx-xxxx".replace(/x/g,function(){return new Number(36*Math.random()|0).toString(36)})},e.flashSupported=function(){return t.Flash.detectFlashVer(9,0,0)},e.getUrl=function(e){return t.Utils.isString(e)?e:t.Utils.isObject(e)?t.Net.isSSL()?null!=e?e.ssl:void 0:null!=e?e.no_ssl:void 0:void 0},e.convertUrls=function(e,n){var i,r,a,o,s,l,u;if(n){for(o=[],r=0,a=n.length;a>r;r++)i=n[r],l=e[i],o.push(null!=l?e[i]=t.Utils.getUrl(l):void 0);return o}s=[];for(i in e)u=e[i],s.push(null!=u?e[i]=t.Utils.getUrl(u):void 0);return s},e.toQueryString=function(e){var t,n,i;if(n=[],null!=e)for(t in e)i=e[t],n.push(t+"="+i);return n.join("&")},e.toCamelCase=function(e){return e.toLowerCase().replace(/_(.)/g,function(e,t){return t.toUpperCase()})},e.isFunction=function(e){return"function"==typeof e},e.isObject=function(e){return"object"==typeof e},e.isString=function(e){return"string"==typeof e},e.compact=function(e){var t,n,i,r;for(null==e&&(e=[]),t=[],n=0,i=e.length;i>n;n++)r=e[n],r&&t.push(r);return t},e.shuffle=function(e){var t,n,i;for(t=e.length;--t>0;)n=~~(Math.random()*(t+1)),i=e[n],e[n]=e[t],e[t]=i;return e},e.random=function(e){return null==e&&(e=1e9),Math.floor(Math.random()*e)},e.keys=function(e){var t,n,i;n=[];for(t in e)i=e[t],e.hasOwnProperty(t)&&n.push(t);return n},e.include=function(e,t){return-1!==e.join("|").indexOf(t)?!0:!1},e}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Iframe=function(){function e(){}var n,i,r;return n="&",e.parse=function(e,r){var a,o,s,l,u,c,d,h,p,f,g,v,m,w,y,k,b,E,T,C;if(null==e&&(e=""),null==r&&(r={}),e.indexOf(";$;")>=0&&(n=";$;"),-1!==e.indexOf("?")){e=e.replace(/.+?\?/,""),i(e,r),d=t.Net.getParams(e,n),p=null!=(f=d.placementId)?f:"",p&&p.length>0&&(r.placementId=p),b=null!=(g=d.siteId)?g:"",b&&b.length>0&&(r.siteId=b),E=null!=(v=d.targeting)?v:"",E&&E.length>0&&(r.targeting=E),k=null!=(m=d.signalData)?m:"",k&&k.length>0&&(r.targeting={ysa:k}),o=null!=(w=d.adTagId)?w:"",o&&o.length>0&&(r.adTagId=o),a=null!=(y=d.activeCreativeId)?y:"",a&&a.length>0&&(r.activeCreativeId=a),c=d.heatMapStartDate,u=d.heatMapStartDate,((null!=c?c.length:void 0)||(null!=u?u.length:void 0))&&(null==r.channels&&(r.channels={}),null==(s=r.channels).remote&&(s.remote={}),r.channels.remote.heatMapStartDate=c,r.channels.remote.heatMapEndDate=u),T=d.trackingEnabled,(null!=T?T.length:void 0)&&(null==r.channels&&(r.channels={}),null==(l=r.channels).tracking&&(l.tracking={}),r.channels.tracking.trackingEnabled="true"===T);for(h in d)C=d[h],r[h]=C}return r},i=function(e,t){var i,r,a,o,s,l,u;if(l="clickTag.?.?.?.?.?=([^("+n+")#]*)",s=new RegExp(l,"g"),o=e.match(s),null!=o){for(i=0,u=[];i<o.length;)a=o[i].replace(n,""),r=a.indexOf("="),r>0&&(t[a.slice(0,r)]=a.slice(r+1)),u.push(++i);return u}},e.addMessageListener=function(e){return null!=window.addEventListener?window.addEventListener("message",r(e),!1):null!=window.attachEvent?window.attachEvent("onmessage",r(e)):void 0},r=function(e){return function(n){var i,r;if("mocha-zero-timeout"!==n.data)try{i=JSON.parse(n.data)}catch(a){return r=a,void t.Console.debug("Iframe parse error: %o",r)}return e(i,n)}},e}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Macros=function(){function e(){this.dynodeObjects={},this.dynamicValues={},this.values={},this.thirdPartyMacroValues={},this.defaultDynamicValues={},this.defaultDynamicValues[r("signal.id")]="",this.defaultDynamicValues[r("signal.name")]="",this.defaultDynamicValues[r("sv.id")]="fallback",this.defaultDynamicValues[r("sv.name")]="fallback",this.defaultDynamicValues[r("item.id")]="",this.defaultDynamicValues[r("item.name")]=""}var n,i,r,a;return e.THIRD_PARTY_PIXEL_NAMES=["impression","dynode","engagement","completion","expansion","clickThrough","landingPages","start","firstQuartile","midpoint","thirdQuartile","complete"],i=null,e.get=function(){return i||(i=new t.Macros),i},e.prototype.dynodeResponse=function(e){var t,n,i,a,o,s,l,u,c,d,h,p,f,g,v,m,w,y,k,b,E;if(t={},m=[],w=[],k=[],b=[],e.signals){for(p=e.signals,n=0,c=p.length;c>n;n++)if(v=p[n],m.push(v.id),w.push(v.name),v.signalValues){for(f=v.signalValues,s=0,d=f.length;d>s;s++)y=f[s],k.push(y.id);for(g=v.signalValues,l=0,h=g.length;h>l;l++)y=g[l],b.push(y.value)}m.length>0&&(t[r("signal.id")]=m),w.length>0&&(t[r("signal.name")]=w),k.length>0&&(t[r("sv.id")]=k),b.length>0&&(t[r("sv.name")]=b)}if(a=[],o=[],e.items&&e.items.length>0){i=e.items[0],a.push(i.id);for(u in i)if(E=i[u],null!=E?E.text:void 0){o.push(E.text);break}t[r("item.id")]=a,t[r("item.name")]=o}return this.addDynodeObject(e.id,t)},e.prototype.addDynodeObject=function(e,t){var n,i,r;this.dynodeObjects[e]=t,i=[];for(n in t)r=t[n],i.push(r instanceof Array?this.dynamicValues[n]?this.dynamicValues[n]=this.dynamicValues[n].concat(r):this.dynamicValues[n]=r:void 0);return i},e.prototype.init=function(e,i){var r,o,s,l,u,c,d,h,p,f,g,v,m,w,y,k,b,E;n(this.values,"flight.id",null!=(l=e.flight)?l.id:void 0),n(this.values,"flight.name",null!=(u=e.flight)?u.name:void 0),n(this.values,"creative.id",null!=(p=e.creative)?p.id:void 0),n(this.values,"creative.name",null!=(f=e.creative)?f.name:void 0),n(this.values,"creative.width",null!=(g=e.creative)?g.width:void 0),n(this.values,"creative.height",null!=(v=e.creative)?v.height:void 0),n(this.values,"tag.id",null!=(m=e.adTag)?m.id:void 0),n(this.values,"tag.name",null!=(w=e.adTag)?w.name:void 0),n(this.values,"placement.id",null!=(y=e.placement)?y.id:void 0),n(this.values,"placement.name",null!=(k=e.placement)?k.name:void 0),n(this.values,"weight",null!=(c=e.weight)?c.value:void 0),n(this.values,"concept.id",null!=(d=e.concept)?d.id:void 0),n(this.values,"site.name",null!=(h=e.site)?h.id:void 0),s=new RegExp("^([A-Za-z]+)[0-9]+$"),b=[];for(r in i)E=i[r],o=r.match(s),b.push(o&&t.Macros.THIRD_PARTY_PIXEL_NAMES.indexOf(o[1])>-1?this.thirdPartyMacroValues[a(r)]=E:void 0);return b},e.prototype.replace=function(e,t){return e=this.replaceValues(e,this.values),e=this.replaceValues(e,this.thirdPartyMacroValues),e=(null!=t?t.sp_id:void 0)?this.replaceValues(e,this.dynodeObjects[t.sp_id]):this.replaceValues(e,this.dynamicValues),e=this.replaceValues(e,this.defaultDynamicValues)},e.prototype.replaceValues=function(e,t){var n,i;for(n in t)i=t[n],e=e.replace(RegExp(n,"g"),this.macroToValue(i));return e},e.prototype.macroToValue=function(e){var t;return t=e instanceof Array?encodeURIComponent(e.join(",")):e},n=function(e,t,n){return e[r(t)]=encodeURIComponent(n)},r=function(e){return"\\$\\{"+e+"\\}"},a=function(e){return"%"+e+"%"},e}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Tracker=function(){function e(e){var t,n;for(t in e)n=e[t],this[t]=n;this.adVersion=this.AD_VERSION_PLATFORM,null==this.iid&&(this.iid="xxxx-xxxx-Axxx-xxxx".replace(/x/g,function(){return new Number(36*Math.random()|0).toString(36)})),this.trackOnce={ENGAGEMENT:!1,MOUSEOVER:!1},this.featureEvents={},this.defaultOptions={}}return e.prototype.METRIC={IMPRESSION:"IMPRESSION",ENGAGEMENT:"ENGAGEMENT",MOUSEOVER:"MOUSEOVER",START:"START",COMPLETION:"COMPLETION",CLICK_THROUGH:"CLICK_THROUGH",DYNODE:"DYNODE",INTERACTION:"INTERACTION",TIME:"TIME",EXPANSION:"EXPANSION"},e.prototype.AD_VERSION_PLATFORM="PLATFORM",e.prototype.trackEvent=function(e){switch(e.action){case"clickThrough":return this.trackClickThrough(e);case"mouseOver":return this.track("MOUSEOVER",e.feature,{description:"Mouse over "+e.feature});case"clickEvent":return this.trackHeatMap(e);case"play":return this.trackPlay(e.feature,e.baseFeature);case"pause":return this.trackPause(e.feature,e.baseFeature);case"unpause":return this.trackUnpause(e.feature,e.baseFeature);case"replay":return this.trackReplay(e.feature,e.baseFeature);case"played":return this.trackPlayed(e.feature,e.percentage,e.baseFeature);case"seek":return this.track("INTERACTION",{feature:e.feature,description:"Seek Video",data:e.data,baseFeature:e.baseFeature});case"mute":return this.track("INTERACTION",{feature:e.feature,description:"Muted Video",data:e.data,baseFeature:e.baseFeature});case"unmute":return this.track("INTERACTION",{feature:e.feature,description:"Unmuted Video",data:e.data,baseFeature:e.baseFeature});case"enterFullscreen":return this.track("INTERACTION",{feature:e.feature,description:"Entered Full Screen",data:e.data});case"exitFullscreen":return this.track("INTERACTION",{feature:e.feature,description:"Exited Full Screen",data:e.data});case"timeStart":return this.timerStart();case"timeStop":return this.timerStop();case"engagement":return this.track("ENGAGEMENT",e);case"start":return this.trackStart(e.feature,e);case"completion":return this.trackCompletion(e.feature,e);case"mobileMapSwipe":return this.track("INTERACTION",{feature:e.feature,description:"Map Swipe",data:e.data});case"mobileMapClickThrough":return this.track("CLICK_THROUGH",{feature:e.feature,description:e.description,data:e.data}),this.track("INTERACTION",{feature:e.feature,description:e.description,data:e.data}),this.trackCompletion(e.feature,e);case"mapGeocoded":return this.track("INTERACTION",{feature:e.feature,description:"IP Geocoded",data:e.data,baseFeature:e.baseFeature});case"slideView":return this.track("ENGAGEMENT",e),this.track("INTERACTION",{feature:e.feature,description:e.description,data:e.data,i:e.i,baseFeature:e.baseFeature}),this.trackStart(e.feature,e);case"mapInteraction":return this.track("INTERACTION",{feature:e.feature,description:e.description,data:e.data,baseFeature:e.baseFeature}),this.trackCompletion(e.feature,e);default:return this.track(e.action,e)}},e.prototype.trackClickThrough=function(e){return this.track("ENGAGEMENT",e),this.track("INTERACTION",e),this.track("CLICK_THROUGH",e),this.trackHeatMap(e)},e.prototype.trackHeatMap=function(e){var n,i,r,a,o;return null==e&&(e={}),a=e.x,o=e.y,n=null!=(i=e.partition)?i:"Creative",null!=a&&null!=o?(t.Console.log("HEATMAP POINT ("+n+"): "+a+", "+o),r=this.heatmapBaseURL+"/create_point?x="+a+"&y="+o+"&partition="+n+"&event=click&heatmap="+this.creative.id,null!=e.elapsed&&(r+="&elapsed="+e.elapsed),this.writePixel(r)):void 0},e.prototype.trackPlay=function(e,t){return this.track("ENGAGEMENT",{feature:e,baseFeature:t}),this.trackStart(e,{baseFeature:t}),this.track("INTERACTION",{feature:e,description:"Started Video",baseFeature:t})},e.prototype.trackReplay=function(e,t){return this.track("INTERACTION",{feature:e,description:"Replayed "+e,baseFeature:t})},e.prototype.trackPause=function(e,t){return this.track("INTERACTION",{feature:e,description:"Paused "+e,baseFeature:t})},e.prototype.trackUnpause=function(e,t){return this.track("INTERACTION",{feature:e,description:"Unpaused "+e,baseFeature:t})},e.prototype.trackPlayed=function(e,t,n){return this.trackOncePerFeature("INTERACTION",e,{description:"Viewed "+t+"%",baseFeature:n,eventName:"INTERACTION"+t}),100===t?this.trackCompletion(e,{description:"Viewed 100%",baseFeature:n}):void 0},e.prototype.trackOncePerFeature=function(e,t,n){var i,r,a,o,s,l;return null==n&&(n={}),i=null!=(s=n.baseFeature)?s:"unknown",null==n.feature&&(n.feature=t),null==(r=this.featureEvents)[i]&&(r[i]={}),null==(a=this.featureEvents[i])[t]&&(a[t]={START:!1,COMPLETION:!1}),o=null!=(l=n.eventName)?l:e,delete n.eventName,this.featureEvents[i][t][o]!==!0&&this.track(e,n),this.featureEvents[i][t][o]=!0},e.prototype.trackStart=function(e,t){return null==t&&(t={}),this.trackOncePerFeature("START",e,t)},e.prototype.trackCompletion=function(e,t){return null==t&&(t={}),this.trackOncePerFeature("COMPLETION",e,t),this.trackStart(e,t)},e.prototype.trackDynode=function(e){return null==e&&(e={}),this.track(this.METRIC.DYNODE,e)},e.prototype.timerStart=function(){return this.timer=setInterval(function(e){return function(){return e.trackTime()}}(this),500)},e.prototype.timerStop=function(){return clearInterval(this.timer)},e.prototype.trackTime=function(){return null==this.timeSpent&&(this.timeSpent=0),this.timeSpent+=.5,this.timeSpent%5===0&&this.timeSpent<=90?this.track("TIME",{duration:this.timeSpent}):void 0},e.prototype.trackOpen=function(){return this.track("EXPANSION"),this.timerStart()},e.prototype.trackClose=function(e){return this.track("INTERACTION",{description:e}),this.timerStop()},e.prototype.track=function(e,n){var i,r,a,o,s,l,u,c,d;if(null==n&&(n={}),e=e.toUpperCase(),this.trackOnce[e]===!1)this.trackOnce[e]=!0;else if(this.trackOnce[e]===!0)return;if(a=t.Console.pad("Tracking "+e+":",24),u=n.feature||"",n.feature&&n.baseFeature&&(u+=" ("+n.baseFeature+")"),a+=t.Console.pad(u,24),n.description&&(a+=t.Console.pad(n.description,32)),n.data&&(a+=t.Console.pad("("+n.data+")",32)),null!=n.i&&(a+=t.Console.pad("("+n.i+")",32)),n.pixel&&(a+=n.pixel),t.Console.group(a),c=this.reportBaseURL+"/"+this.adTag.id+"?",o=[],i=function(){return function(e,n,i){return null==i&&(i=!1),o.push([e,encodeURIComponent(n)].join("=")),t.Console.groupCollapsedSupported()?t.Console.log(e+": "+n):void 0}}(this),i("type",e),n.creativeOptions){s=n.creativeOptions;for(r in s)d=s[r],i(r,d)}l=this.defaultOptions;for(r in l)d=l[r],null==n[r]&&i(r,d);return n.feature&&i("screen",n.feature),n.baseFeature&&i("base_screen",n.baseFeature),n.description&&i("description",n.description),n.duration&&i("duration",n.duration),n.item_id&&i("item_id",n.item_id),n.sp_id&&i("sp_id",n.sp_id),n.srcdoc&&i("srcdoc",n.srcdoc),n.sv_id&&i("sv_id",n.sv_id),n.data&&i("data",n.data),null!=n.i&&i("i",n.i),i("flight_id",this.flight.id),i("creative_id",this.creative.id),i("iid",this.iid),this.container&&i("container_id",this.container.id),this.concept&&i("concept_id",this.concept.id),this.rotationGroup&&i("rg_id",this.rotationGroup.id),this.weight&&i("weight",this.weight.value),i("ad_version",n.adVersion?n.adVersion:this.adVersion),this.placement.id&&i("external_placement_id",this.placement.id),this.site.id&&i("external_site_id",this.site.id),this.ysa&&i("ysa",this.ysa),i("anticache",(new Date).getTime()),i("e","mc2"),c+=o.join("&"),t.Console.groupCollapsedSupported()&&t.Console.log("Analytics URL: "+c),this.writePixel(c),"IMPRESSION"===e&&n.item_id||this.trackExternalPixels(e,n),t.Console.groupEnd()},e.prototype.trackExternalPixels=function(e,n){var i,r,a,o,s,l;if(e=t.Utils.toCamelCase(e),null!=(null!=(s=this.pixels[n.feature])?s[e]:void 0))return this.trackPixel(this.pixels[n.feature][e],e,n);if(o=this.pixels[e+"s"]){for(l=[],i=0,r=o.length;r>i;i++)a=o[i],l.push(this.trackPixel(a,e,n));return l}return this.trackPixel(this.pixels[e],e,n)},e.prototype.trackPixel=function(e,n,i){return e=t.Tracker.substituteVariables(e,i),e&&(t.Console.log("PIXEL: "+e),this.writePixel(e)),this.trackActivityPixel(n,i)},e.prototype.trackActivityPixel=function(e,n){var i;return i=this.pixels.activity,i=t.Tracker.substituteVariables(i,n),i?(i=i.replace("[activity]",e),i=i.replace("[feature]",n.feature||""),i=i.replace("[base_feature]",n.baseFeature||n.feature||""),this.writePixel(i),t.Console.log("Activity pixel: "+i)):void 0},e.prototype.writePixel=function(e){return this.trackingDisabled?void 0:t.Net.writePixel(e,document.getElementById("spongecell-ad-"+this.iid))},e.prototype.trackImpression=function(e){return this.track(this.METRIC.IMPRESSION,e)},e.substituteVariables=function(e,n){null==e&&(e=""),null==n&&(n={});try{e=t.Macros.get().replace(e,n)}catch(i){}return e=e.replace(/\[clickTag.*?\]/g,""),e=e.replace(/\[rand\]/g,Math.floor(1e10*Math.random())),e=e.replace(/\[timestamp\]/g,(new Date).getTime().toString())},e.prototype.inspect=function(){return"Campaign: "+this.campaign.id+"    Flight: "+(this.flight.id||"")+"    Ad Tag: "+(this.adTag.id||"")+"    Creative: "+this.creative.id+"    Placement: "+(this.placement.id||"")+"    Site: "+this.site.id+"    IID: "+this.iid},e}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.BaseChannel=function(){function e(e,t,n){this.iid=e,this.options=t,this.impTag=n,this._init()}return e.prototype._init=function(){},e.prototype.start=function(){},e.prototype.send=function(e){return t.Console.log("BaseChannel received %o",e)},e}()}.call(this),function(){"use strict";var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.Broker=function(){function e(){}var n,i,r,a,o,s,l;return n=null!=t.brokerChannels?t.brokerChannels:t.brokerChannels={},i=null!=t.brokerClients?t.brokerClients:t.brokerClients={},s=null!=t.brokerChannels?t.brokerChannels:t.brokerChannels={},a=function(){return t.Utils.random(1e5)+"_"+ +new Date},o=function(e){return s[e]},l=function(e,t){return s[e]=t},r=function(e){var n;return n="call"+e,null==t.callbacks&&(t.callbacks={}),t.callbacks[n]=function(t){return s[e](t)},"spongecell.callbacks."+n},e.registerCallbackFn=function(e){var n;return n=a(),l(n,function(){var i,r,a,o;e.apply(null,arguments),r=t.requestMap,a=[];for(i in r)o=r[i],a.push(o.indexOf(n)>-1?delete r[i]:void 0);return a}),r(n)},e.registerChannels=function(e,i,r){var a,o,s,l,u;t.Console.group("Registering Channels for %s, %o",e,i),o={};for(u in i)l=i[u],a=function(){switch(u){case"feature":return t.FeatureChannel;case"hooks":return t.HooksChannel;case"mraid":return t.MRAIDChannel;case"nav":return t.NavChannel;case"panel":return t.PanelChannel;case"remote":return t.RemoteChannel;case"setup":return t.SetupChannel;case"tracking":return t.TrackingChannel}}(),null!=a&&(t.Console.debug("Initializing Channel: %s with %o",u,l),o[u]=new a(e,l,r));n[e]=o;for(u in o)s=o[u],t.Console.debug("Starting Channel: %s",u),s.start();return t.Console.groupEnd(),o},e.registerClient=function(e,t){return null==i[e]&&(i[e]=[]),i[e].push(t)},e.clientRegistered=function(e){var t;return(null!=(t=i[e])?t.length:void 0)>0},e.sendOnChannel=function(e,t){var r,a,o,s,l,u;if(e.iid&&(r=n[e.iid]),null!=r&&(o=r[e.topic],null!=o&&o.send(e,t)),null!=(a=i[e.topic])){for(u=[],s=0,l=a.length;l>s;s++)t=a[s],u.push(t(e));return u}},e}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.CreativeTag=function(){function e(e,n){this.iid=e,t.Utils.extend(this,n),this._init()}return e.prototype._init=function(){},e.prototype.html=function(){},e}()}.call(this),function(){var e,t;e="undefined"!=typeof window&&null!==window?window:global,t=null!=e.spongecell?e.spongecell:e.spongecell={},t.ImpressionTag=function(){function e(e,n){var i,r,a,o,s,l,u,c,d,h;this.params=n,this.params.iframeSrc&&t.Iframe.parse(this.params.iframeSrc,this.params),this.creativeSettings=r=this.rotate(e.creatives),this.creativeImpressionTrackingOptions={},this.iid=t.Utils.generateIID(),this.size=r.size,t.Console.debug("Impression Tag %s initializing with %o rotated to %o",this.iid,e,r),o=e.channels;for(h in o)a=o[h],"object"==typeof a&&(null==(i=r.channels)[h]&&(i[h]={}),t.Utils.extend(r.channels[h],a));s=r.channels;for(h in s)e=s[h],null!=(null!=(l=this.params)&&null!=(u=l.channels)?u[h]:void 0)&&t.Utils.extend(e,this.params.channels[h]);t.Broker.registerChannels(this.iid,r.channels,this),this.sendDebugMessage({description:"tag_init",type:"start"}),this._initTags(r.tags),t.Console.group(null!=(c=this.tracker)?c.inspect():void 0),t.Console.log("Ad Tag: %O",this),t.Console.log("Ad Server Parameters: %O",this.params),t.Console.groupEnd(),(null!=(d=this.params.targeting)?d.ysa:void 0)&&(this.creativeImpressionTrackingOptions.ysa=this.params.targeting.ysa),this.sendChannelMessage("hooks",{description:"before_ad_load_hook",type:"beforeAdLoad"})}return e.prototype._initTags=function(e){var n,i,r,a,o,s;r=[];for(o in e)switch(a=e[o],t.Console.debug("Initializing Tag: %s tag with %o",o,a),o){case"backup":a.clickTags=this.clickTags,a.tracker=this.tracker,a.macros={},i=this.params;for(n in i)s=i[n],a.macros[n]=s;r.push(this.backupTag=new t.BackupTag(this.iid,a));break;case"flash":r.push(this.flashTag=new t.FlashTag(this.iid,a));break;case"studioIframe":r.push(this.studioTag=new t.StudioIframeTag(this.iid,a,this));break;case"studioScript":r.push(this.studioTag=new t.StudioScriptTag(this.iid,a,this));break;case"panel":this.panelTag=new t.PanelTag(t.Utils.generateIID(),a,this),r.push(this.sendChannelMessage("panel",{description:"setup_panel_or_site_window",action:"setup"}));break;default:r.push(void 0)}return r},e.prototype.render=function(){var e,n,i,r,a,o;return e=null!=document.body?this._html():"<html><body>"+this._html()+"</body></html>",null!=this.params.currentScript?(t.Console.debug("Rendering self after %o: %o",this.params.currentScript),this.params.currentScript.insertAdjacentHTML("afterEnd",e)):document.write(e),this._addLoadListeners(),this.hasBackup||null!=(n=this.studioTag)&&n.delegateEvents(),document.close(),null!=(i=this.tracker)&&i.trackImpression(this.creativeImpressionTrackingOptions),this.sendChannelMessage("panel",{description:"setup_initial_expansion",action:"initialExpansion"}),this.sendDebugMessage({description:null!=(r=null!=(a=this.creativeImpressionTrackingOptions.creativeOptions)?a.screen:void 0)?r:null!=(o=this.creativeImpressionTrackingOptions.creativeOptions)?o.feature:void 0,type:"IMPRESSION"}),this.sendDebugMessage({description:"tag_init",type:"stop"})},e.prototype._html=function(){var e,t,n,i,r,a,o,s;if(null==(e=this.creativeImpressionTrackingOptions).creativeOptions&&(e.creativeOptions={}),!(null!=(a=this.panelTag)?a.director:void 0)||this.panelTag.director.allowedAccessToTop()){for(o=[this.flashTag,this.studioTag,this.backupTag],i=0,r=o.length;r>i;i++)if(s=o[i],null!=s?s.checkEnvironment(this.creativeImpressionTrackingOptions.creativeOptions):void 0){t=s;break}}else t=this.backupTag;return t===this.backupTag&&(this.hasBackup=!0),n='<div id="spongecell-ad-'+this.iid+'" class="spongecell-ad" style="display: inline-block; *display: inline; width: '+this.size.width+"px; height: "+this.size.height+'px; opacity: 1; filter: alpha(opacity=100); ">\n  '+(null!=t?t.html():void 0)+"\n</div>"},e.prototype.random=function(){return Math.floor(1e9*Math.random())},e.prototype.rotate=function(e){var n,i,r,a,o,s,l,u;if(l={},null!=this.params.activeCreativeId)return e[this.params.activeCreativeId];s=function(){var t;t=[];for(a in e)u=e[a],t.push(a);return t}().length>1,r=0,o=Math.random(),s&&t.Console.group("Rotating");for(i in e){if(n=e[i],r+=n.weight,r>o){l=n;break}s&&t.Console.log(i+": "+100*n.weight+"%")}return s&&t.Console.groupEnd(),l},e.prototype._addLoadListeners=function(){var e;return t.Event.onLoad(function(e){return function(){return e.panelTag&&e.sendChannelMessage("panel",{description:"start_auto_expand_timer",action:"autoExpand"}),e.sendChannelMessage("hooks",{description:"after_page_load_hook",type:"afterPageLoad"})}}(this)),null!=(e=this.backupTag)?e.addClickthroughListener():void 0},e.prototype.sendDebugMessage=function(e){return this.sendChannelMessage("debug",e)},e.prototype.sendChannelMessage=function(e,n){return null!=t.Broker?(null==n.iid&&(n.iid=this.iid),null==n.topic&&(n.topic=e),t.Broker.sendOnChannel(n)):void 0},e}()}.call(this);
(function(){var t,e,n=function(t,e){function n(){this.constructor=t}for(var s in e)i.call(e,s)&&(t[s]=e[s]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;t="undefined"!=typeof window&&null!==window?window:global,e=null!=t.spongecell?t.spongecell:t.spongecell={},e.SetupChannel=function(i){function s(){return s.__super__.constructor.apply(this,arguments)}return n(s,i),s.prototype._init=function(){return this.options.disableFullScreen=this.disableFullScreenAccess(),this.options.mraid="undefined"!=typeof mraid&&null!==mraid&&mraid,e.Utils.convertUrls(this.options,["creativeSwfUrl","sharedBaseUrl","studioAssetBaseUrl"]),e.Utils.convertUrls(this.options.urls),null!=this.options.assets?this.baseAssets():void 0},s.prototype.start=function(){var t;return t=this.findClickTags(this.impTag.params),this.options.mergedLandingPages=this.mergeClickTagsAndLandingPages(t,this.options.landingPages),this.options.clickTagsAndLandingPages=this.flashifyLandingPages(t,this.options.mergedLandingPages),e.Console.log("ClickTags + Landing Pages: %o",this.options.clickTagsAndLandingPages),e.Utils.extend(this.options,this.options.clickTagsAndLandingPages),this.impTag.clickTags=t},s.prototype.send=function(t,n){var i,s;return t.action?"polite"===t.action?(this.impTag.sendDebugMessage({description:"tag_polite",type:"start"}),s=!!document&&"complete"===document.readyState,i=function(t){return function(){return n(),t.impTag.sendDebugMessage({description:"tag_polite",type:"stop"})}}(this),s?i():e.Event.onLoad(i)):void 0:n(this.options)},s.prototype.baseAssets=function(){var t,e,n,i,s;i=this.options.assets,s=[];for(n in i)t=i[n],t.url=""+this.options.studioAssetBaseUrl+t.path,s.push(function(){var n,i,s,o,r;for(o=null!=(s=t.children)?s:[],r=[],n=0,i=o.length;i>n;n++)e=o[n],r.push(e.url=""+this.options.studioAssetBaseUrl+e.path);return r}.call(this));return s},s.prototype.mergeClickTagsAndLandingPages=function(t,n){var i,s,o,r,a,l,c,p,u,g,d;l={},i=t.clickTag;for(r in n){d=n[r],s=null!=(p=t["clickTag"+r])?p:i,c=s?s+d:d,c=e.Tracker.substituteVariables(c),u=this.impTag.params;for(o in u)g=u[o],c=c.replace("%"+o+"%",g);l[r]=c}for(r in t)d=t[r],a=r.replace("clickTag",""),null==l[a]&&(l[a]=d);return l},s.prototype.flashifyLandingPages=function(t,e){var n,i,s,o,r,a;s={};for(i in e)a=e[i],i="clickTag"+i,s[i]=a;for(i=n=1;20>=n;i=++n)null==s[o="clickTag"+i]&&(s[o]=null!=(r=t.clickTag)?r:"");return s},s.prototype.findClickTags=function(t){var n,i,s;n={};for(i in t)s=t[i],0===i.indexOf("clickTag")&&(e.Net.isHttp(s)||e.Net.isHttpEncoded(s)?e.Net.isHttpEncoded(s)&&(s=decodeURIComponent(s)):s="",n[i]=s);return n},s.prototype.disableFullScreenAccess=function(){var e,n,i;try{for(n=null!=t?t.frameElement:void 0,i=t;n&&i&&i!==top;)n.setAttribute("allowfullscreen","true"),n.setAttribute("webkitallowfullscreen","true"),n.setAttribute("mozallowfullscreen","true"),i=i.parent,n=i.frameElement;return!1}catch(s){return e=s,!0}},s}(e.BaseChannel)}).call(this);
(function(){var t,i,n=function(t,i){function n(){this.constructor=t}for(var s in i)o.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},o={}.hasOwnProperty;t="undefined"!=typeof window&&null!==window?window:global,i=null!=t.spongecell?t.spongecell:t.spongecell={},i.TrackingChannel=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype._init=function(){var t;t=this.impTag.params,this._checkParam(t,"activityPixel")&&(this.options.pixels.activity=t.activityPixel),this._checkParam(t,"placementId")&&(this.options.placement.id=t.placementId),this._checkParam(t,"siteId")&&(this.options.site.id=t.siteId);try{i.Macros.get().init(this.options,this.impTag.params)}catch(n){}return i.Utils.convertUrls(this.options,["heatMapBaseUrl","trackingBaseUrl"]),this.options.heatMapTrackingEnabled=this.options.heatMapEnabled,this.options.heatmapBaseURL=this.options.heatMapBaseUrl,this.options.reportBaseURL=this.options.trackingBaseUrl,this.options.trackingDisabled=!this.options.trackingEnabled,this.options.iid=this.iid,this.impTag.tracker=this.tracker=new i.Tracker(this.options),this.impTag.creativeImpressionTrackingOptions={}},o.prototype.send=function(t){return this.tracker.trackEvent(t)},o.prototype._checkParam=function(t,i){return t[i]&&!this._isMacro(i,t.activityPixel)},o.prototype._assignThirdPartyPixel=function(t){var i,n;return i=t+"s",(null!=(n=this.options.pixels[i])?n.length:void 0)>0?this.options.pixels[t]=this.options.pixels[i][0]:void 0},o.prototype._isMacro=function(t,i){var n,o,s;s=this.options.macros[t]||[];for(n in s)if(o=s[n],i===o)return!0;return!1},o}(i.BaseChannel)}).call(this);
(function(){var t,e,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;t="undefined"!=typeof window&&null!==window?window:global,e=null!=t.spongecell?t.spongecell:t.spongecell={},e.BackupTag=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return r(n,t),n.prototype._init=function(){return e.Utils.convertUrls(this,["imageUrl"])},n.prototype.checkEnvironment=function(t){return t.screen="DEFAULT",!0},n.prototype.html=function(){var t,r,n,i,c;if(t='<img alt="" border="0" height="'+this.size.height+'" src="'+this.imageUrl+'" width="'+this.size.width+'" />',null!=this.linkUrl){i=this.linkUrl,i=i.replace(/\*\*click_tag\*\*/g,encodeURIComponent(this.clickTags.clickTag)),i=i.replace(/\*\*iid\*\*/g,this.tracker.iid),i=i.replace(/\*\*random\*\*/g,e.Utils.random()),i=i.replace(/\*\*placement_id\*\*/g,this.tracker.placement.id?e.Net.encode(this.tracker.placement.id):""),i=i.replace(/\*\*site_id\*\*/g,this.tracker.site.id?e.Net.encode(this.tracker.site.id):""),n=this.macros;for(r in n)c=n[r],i=i.replace("%"+r+"%",c);return'<a href="'+i+'" target="_blank" id="backup_link">'+t+"</a>"}return t},n.prototype.addClickthroughListener=function(){var t,e;return e=function(t){return function(){return t.clicked?(event.preventDefault(),event.stopPropagation()):t.tracker.trackExternalPixels("click_through",{}),t.clicked=!0,setTimeout(function(){return t.clicked=!1},400)}}(this),t=document.getElementById("backup_link"),null!=t?t.addEventListener("click",function(){return function(){return e()}}(this)):void 0},n}(e.CreativeTag)}).call(this);
(function(){var t,e,n=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t="undefined"!=typeof window&&null!==window?window:global,e=null!=t.spongecell?t.spongecell:t.spongecell={},e.FlashTag=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype._init=function(){return e.Utils.convertUrls(this,["gridSwfUrl"])},o.prototype.checkEnvironment=function(t){return e.Utils.flashSupported()?!0:(t.noflash=!0,!1)},o.prototype.html=function(){return this.teaser?this.teaserHtml():this.flashHtml()},o.prototype.flashHtml=function(){var t,n;return t=e.Broker.registerCallbackFn(function(t){return function(e){return t._receiveMessage(e)}}(this)),n="iid="+this.iid+"&channelInterface="+t,e.Flash.html(this.getSwfId(),this.gridSwfUrl,this.size.width,this.size.height,n)},o.prototype.teaserHtml=function(){return'<div id="spongecell-teaser-'+this.iid+'" style="overflow:hidden; display:inline-block; position:relative;">\n  '+this.flashHtml()+"\n</div>"},o.prototype.getSwf=function(){return document[this.getSwfId()]},o.prototype.getSwfId=function(){return"spongecell-flash-ad-"+this.iid},o.prototype._receiveMessage=function(t){return e.Console.log("Receiving message from Flash Ad: %o",t),e.Broker.sendOnChannel(t,function(e){return function(n){return t.callback?e._sendMessage({topic:t.topic,callback:t.callback,response:n}):void 0}}(this)),!t.callback},o.prototype._sendMessage=function(t){var n;e.Console.debug("Sending message %o back to Flash Ad",t);try{return this.getSwf()[t.callback](t)}catch(o){return n=o,"undefined"!=typeof console&&null!==console?console.debug("--> threw %o",n):void 0}},o}(e.CreativeTag)}).call(this);
var impressionTag = new spongecell.ImpressionTag(impressionTagOptions, spongecellParams);
impressionTag.render();

